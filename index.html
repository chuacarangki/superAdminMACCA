<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MACCA SUPER ADMIN v20.1</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        :root { --gold: #FFD700; --dark: #000000; --card: #121212; --cyan: #00E5FF; --red: #FF0000; --orange: #FF8C00; --blue: #3b82f6; --emerald: #10b981; --purple: #a855f7; }
        body { background-color: var(--dark); color: #ffffff; font-family: 'Plus Jakarta Sans', sans-serif; overflow: hidden; }
        
        #login-overlay { position: fixed; inset: 0; background: var(--dark); z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.8s cubic-bezier(0.85, 0, 0.15, 1); }
        .btn-login { background: white; color: black; padding: 16px 50px; border-radius: 50px; font-weight: 800; letter-spacing: 1px; box-shadow: 0 0 20px rgba(255,255,255,0.2); }
        .welcome-msg { display: none; font-size: 26px; font-weight: 900; color: var(--gold); text-align: center; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.6; transform: scale(0.95); } }

        #main-app { display: none; height: 100vh; overflow-y: auto; }
        .nav-active { color: var(--gold); background: rgba(255, 215, 0, 0.15); border-top: 3px solid var(--gold); }
        .page-content { display: none; }
        .page-content.active { display: block; }
        
        .stat-card { background: var(--card); border: 1px solid rgba(255,255,255,0.08); border-radius: 20px; padding: 20px; position: relative; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .card-icon-bg { position: absolute; right: 15px; bottom: 12px; font-size: 3.5rem; opacity: 0.08; transform: rotate(-15deg); pointer-events: none; }

        .text-header-small { font-size: 11px; font-weight: 700; color: #888888; letter-spacing: 1.2px; text-transform: uppercase; }
        .nama-pemesan { font-size: 16px; font-weight: 800; color: var(--cyan); line-height: 1.2; }
        
        .tab-btn { flex: 1; padding: 12px; font-size: 11px; font-weight: 800; color: #666; border-radius: 12px; transition: 0.3s; text-transform: uppercase; }
        .tab-btn.active { color: var(--gold); background: rgba(255, 215, 0, 0.1); border: 1px solid rgba(255, 215, 0, 0.3); }
        
        select, input[type="date"], input[type="number"] { background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 14px; padding: 14px; width: 100%; font-size: 14px; font-weight: 600; outline: none; }
        .btn-update { position: fixed; bottom: 100px; right: 20px; z-index: 1000; background: #222; color: white; font-size: 10px; font-weight: 800; padding: 10px 18px; border-radius: 50px; border: 1px solid #444; }
        
        .modal-overlay { display: none; position: fixed; inset: 0; z-index: 10000; background: rgba(0,0,0,0.85); backdrop-filter: blur(8px); align-items: center; justify-content: center; padding: 20px; }
        .modal-overlay.show { display: flex; }
        .modal-content { background: #161616; border: 1px solid var(--gold); border-radius: 25px; width: 100%; max-width: 320px; padding: 25px; transform: scale(0.9); transition: 0.3s; }
        #toast-notif { position: fixed; top: -100px; left: 50%; transform: translateX(-50%); background: #10b981; color: white; padding: 12px 25px; border-radius: 50px; font-weight: 800; z-index: 11000; transition: 0.5s; }
        #toast-notif.show { top: 30px; }
    </style>
</head>
<body class="antialiased pb-32">

    <div id="toast-notif" class="uppercase">Berhasil Disimpan!</div>

    <div id="modal-stok" class="modal-overlay">
        <div class="modal-content">
            <p id="modal-title-type" class="text-header-small mb-1">TAMBAH STOK</p>
            <h2 id="modal-title-main" class="text-xl font-black italic text-white mb-4 uppercase">Update Stok Baru</h2>
            
            <select id="modal-admin-action" class="mb-4" onchange="updateModalLabel()">
                <option value="Masuk">TAMBAH STOK (BELI/BARU)</option>
                <option value="Proses" id="opt-proses">PROSES UNGKEP (KURANGI MENTAH)</option>
            </select>

            <input type="number" id="modal-qty-input" placeholder="0" autofocus>
            <button onclick="prosesSimpanAdmin()" class="w-full bg-yellow-400 text-black font-bold py-4 rounded-xl mt-4 uppercase">SIMPAN KE DATABASE</button>
            <button onclick="closeModal()" class="w-full text-zinc-500 font-bold py-4 uppercase text-xs">BATAL</button>
        </div>
    </div>

    <div id="login-overlay">
        <div id="login-content" class="text-center">
            <h1 class="text-3xl font-black italic mb-2 uppercase tracking-tighter">MACCA <span style="color:var(--red)">SUPER</span> ADMIN</h1>
            <p class="text-zinc-500 font-bold mb-10 text-xs tracking-[0.3em]">APAKAH ANDA ADMIN?</p>
            <button onclick="handleLogin()" class="btn-login uppercase">YA, SAYA ADMIN</button>
        </div>
        <div id="welcome-box" class="welcome-msg italic uppercase tracking-tighter">Selamat Datang Pak Boss</div>
    </div>

    <div id="main-app">
        <button onclick="location.reload()" class="btn-update uppercase"><i class="fas fa-sync-alt mr-1"></i> Perbarui</button>

        <header class="p-6 sticky top-0 bg-black/90 backdrop-blur-lg z-50 border-b border-white/10 flex justify-between items-center">
            <div><h1 class="text-xl font-black italic uppercase leading-none tracking-tighter">MACCA <span style="color:var(--red)">SUPER</span> ADMIN</h1></div>
            <div id="sync-indicator" class="w-3 h-3 bg-emerald-500 rounded-full"></div>
        </header>

        <main id="page-dashboard" class="page-content active p-6 space-y-6">
            <div class="stat-card border-l-4 border-gold">
                <p class="text-header-small mb-1">Pendapatan Kopi 2026</p>
                <h2 id="dash-kopi-total" class="text-4xl font-black italic text-gold">Rp 0</h2>
                <i class="fas fa-coffee card-icon-bg text-gold"></i>
            </div>

            <div class="stat-card border-l-4 border-purple">
                <p class="text-header-small mb-1">Omzet Gerai Depan (Hari Ini)</p>
                <h2 id="dash-gerai-total" class="text-4xl font-black italic text-purple-400">Rp 0</h2>
                <i class="fas fa-store card-icon-bg text-purple-500"></i>
            </div>

            <div class="grid grid-cols-2 gap-3">
                <div class="stat-card border-t-2 border-orange-500 px-4">
                    <p class="text-[9px] font-bold text-zinc-500 mb-1 uppercase">A. Mentah</p>
                    <h4 id="dash-mentah-val" class="text-2xl font-black italic text-orange-400">0</h4>
                </div>
                <div class="stat-card border-t-2 border-yellow-500 px-4">
                    <p class="text-[9px] font-bold text-zinc-500 mb-1 uppercase">A. Ungkep</p>
                    <h4 id="dash-ungkep-val" class="text-2xl font-black italic text-yellow-400">0</h4>
                </div>
                <div class="stat-card border-t-2 border-emerald-500 px-4">
                    <p class="text-[9px] font-bold text-zinc-500 mb-1 uppercase">I. Tawar</p>
                    <h4 id="dash-ikan-val" class="text-2xl font-black italic text-emerald-400">0</h4>
                </div>
                <div class="stat-card border-t-2 border-cyan-400 px-4">
                    <p class="text-[9px] font-bold text-zinc-500 mb-1 uppercase">I. Laut</p>
                    <h4 id="dash-ikanlaut-val" class="text-2xl font-black italic text-cyan-400">0</h4>
                </div>
            </div>

            <div class="stat-card border-l-4 border-blue-500 flex justify-between items-center">
                <div><p class="text-header-small mb-1">Laundry (Menunggu)</p><h4 id="dash-laundry-count" class="text-3xl font-black italic text-blue-400">0</h4></div>
                <i class="fas fa-tshirt card-icon-bg text-blue-500"></i>
            </div>
        </main>

        <main id="page-stok" class="page-content p-6 space-y-6">
            <div class="grid grid-cols-2 gap-3">
                <div class="stat-card p-4 border-t-2 border-orange-500" onclick="openModalFAB('Mentah')">
                    <p class="text-[10px] text-zinc-500 font-bold uppercase">Ayam Mentah</p>
                    <h4 id="stok-mentah-val" class="text-3xl font-black italic text-orange-400">0</h4>
                </div>
                <div class="stat-card p-4 border-t-2 border-yellow-500" onclick="openModalFAB('Ungkep')">
                    <p class="text-[10px] text-zinc-500 font-bold uppercase">Ayam Ungkep</p>
                    <h4 id="stok-ungkep-val" class="text-3xl font-black italic text-yellow-400">0</h4>
                </div>
                <div class="stat-card p-4 border-t-2 border-emerald-500" onclick="openModalFAB('Ikan')">
                    <p class="text-[10px] text-zinc-500 font-bold uppercase">Ikan Tawar</p>
                    <h4 id="stok-ikan-val" class="text-3xl font-black italic text-emerald-400">0</h4>
                </div>
                <div class="stat-card p-4 border-t-2 border-cyan-400" onclick="openModalFAB('IkanLaut')">
                    <p class="text-[10px] text-zinc-500 font-bold uppercase">Ikan Laut</p>
                    <h4 id="stok-ikanlaut-val" class="text-3xl font-black italic text-cyan-400">0</h4>
                </div>
            </div>
            <div class="flex justify-between items-center px-1"><h3 class="text-header-small font-black">Riwayat Aktivitas Dapur</h3></div>
            <div id="list-history-stok" class="space-y-3"></div>
        </main>

        <main id="page-kopi" class="page-content p-6 space-y-6">
            <div class="flex bg-zinc-900 p-1 rounded-2xl">
                <button onclick="setModeKopi('hari')" id="k-tab-hari" class="tab-btn active">Harian</button>
                <button onclick="setModeKopi('bulan')" id="k-tab-bulan" class="tab-btn">Bulanan</button>
            </div>
            <div class="stat-card">
                <div id="k-wrap-hari"><input type="date" id="k-input-hari" onchange="renderKopi()"></div>
                <div id="k-wrap-bulan" class="hidden grid grid-cols-2 gap-2">
                    <select id="k-input-bulan" onchange="renderKopi()"></select>
                    <select id="k-input-bulan-thn" onchange="renderKopi()"></select>
                </div>
            </div>
            <div class="text-center bg-zinc-900/50 p-6 rounded-3xl border border-white/5"><h2 id="k-total-display" class="text-4xl font-black text-gold italic">Rp 0</h2><p class="text-header-small mt-1">Total Pendapatan</p></div>
            <div id="list-kopi" class="space-y-4"></div>
        </main>

        <main id="page-driver" class="page-content p-6 space-y-6">
            <div class="stat-card border-l-4 border-cyan-500">
                <p class="text-header-small mb-1">Filter Rekap Driver</p>
                <div class="grid grid-cols-2 gap-2 mt-3">
                    <select id="d-select-bulan" onchange="renderDriverPerformance()"></select>
                    <select id="d-select-tahun" onchange="renderDriverPerformance()"></select>
                </div>
            </div>
            <div id="driver-performance-list" class="space-y-4"></div>
        </main>

        <main id="page-laundry" class="page-content p-6 space-y-6">
            <div class="stat-card"><input type="date" id="l-input-date" onchange="renderLaundry()"></div>
            <div id="list-laundry" class="space-y-4"></div>
        </main>

        <nav class="fixed bottom-0 left-0 right-0 z-50 bg-black/95 border-t border-white/10 flex justify-around p-4 backdrop-blur-xl">
            <button onclick="switchPage('dashboard', this)" class="flex flex-col items-center gap-1 nav-active w-full"><i class="fas fa-home text-lg"></i><span class="text-[8px] font-bold uppercase">Home</span></button>
            <button onclick="switchPage('kopi', this)" class="flex flex-col items-center gap-1 text-zinc-500 w-full"><i class="fas fa-coffee text-lg"></i><span class="text-[8px] font-bold uppercase">Kopi</span></button>
            <button onclick="switchPage('driver', this)" class="flex flex-col items-center gap-1 text-zinc-500 w-full"><i class="fas fa-users text-lg"></i><span class="text-[8px] font-bold uppercase">Driver</span></button>
            <button onclick="switchPage('stok', this)" class="flex flex-col items-center gap-1 text-zinc-500 w-full"><i class="fas fa-box text-lg"></i><span class="text-[8px] font-bold uppercase">Stok</span></button>
            <button onclick="switchPage('laundry', this)" class="flex flex-col items-center gap-1 text-zinc-500 w-full"><i class="fas fa-tshirt text-lg"></i><span class="text-[8px] font-bold uppercase">Laundry</span></button>
        </nav>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        const app = initializeApp({ apiKey: "AIzaSyAf4pkzvpCuzmXquzIoCDXLAr6-_l3i8O0", projectId: "kopi-shaka" });
        const db = getFirestore(app);
        window.allKopi = [];
        onSnapshot(query(collection(db, "transactions"), orderBy("tgl", "desc")), (snap) => {
            window.allKopi = snap.docs.map(doc => doc.data());
            const rev = window.allKopi.filter(t => new Date(t.tgl).getFullYear() === 2026).reduce((a,b) => a+(b.total||0),0);
            document.getElementById('dash-kopi-total').innerText = "Rp " + rev.toLocaleString();
            if(window.renderKopi) window.renderKopi();
        });
    </script>

    <script>
        const configStok = { apiKey: "AIzaSyCCmKgOnBFpluEKuycYjrBRm4zbxrHI1P8", databaseURL: "https://stocklistmacca-default-rtdb.asia-southeast1.firebasedatabase.app" };
        const configLaundry = { apiKey: "AIzaSyA-1GyDIS77tlL0vpiZS_ZLvx1S71TnkQU", databaseURL: "https://awwabim-laundry-default-rtdb.firebaseio.com" };
        const configDelivery = { apiKey: "AIzaSyBjEI1iiOjfrpyaZzEntRCGuiiorgxol0", databaseURL: "https://lesehan-macca-new-default-rtdb.asia-southeast1.firebasedatabase.app" };

        firebase.initializeApp(configStok, "STOK");
        firebase.initializeApp(configLaundry, "LAUNDRY");
        firebase.initializeApp(configDelivery, "DELIVERY");

        const dbStok = firebase.app("STOK").database();
        const dbLaundry = firebase.app("LAUNDRY").database();
        const dbDelivery = firebase.app("DELIVERY").database();

        let rawLaundry = [], rawDelivery = [], modeKopi = 'hari', currentTypeFAB = '';

        function handleLogin() {
            document.getElementById('login-content').style.display = 'none';
            document.getElementById('welcome-box').style.display = 'block';
            setTimeout(() => { document.getElementById('login-overlay').style.transform = 'translateY(-100%)'; document.getElementById('main-app').style.display = 'block'; }, 1500);
        }

        // --- SYNC STOK & OMZET GERAI ---
        dbStok.ref('stok_macca_v14_flow').on('value', snap => {
            let sM = 0, sU = 0, sI = 0, sIL = 0, omzetGerai = 0, hArr = [];
            const todayStr = new Date().toDateString();

            snap.forEach(c => {
                const i = c.val(); 
                const isKeluar = i.status === 'Keluar' || i.note?.includes('KELUAR') || i.note?.includes('PENJUALAN');
                const add = isKeluar ? -i.qty : i.qty;
                
                // Hitung Stok
                if(i.type === 'Mentah') sM += add; 
                else if(i.type === 'Ungkep') sU += add; 
                else if(i.type === 'Ikan') sI += add;
                else if(i.type === 'IkanLaut') sIL += add;

                // Hitung Omzet Gerai (Status Keluar + Note Penjualan + Tanggal Hari Ini)
                if(isKeluar && i.note?.includes('PENJUALAN')) {
                    const itemDate = new Date(i.time).toDateString();
                    if(itemDate === todayStr) {
                        omzetGerai += (i.price || 0);
                    }
                }
                
                hArr.push(i);
            });

            document.getElementById('dash-gerai-total').innerText = "Rp " + omzetGerai.toLocaleString();
            
            ['dash', 'stok'].forEach(p => { 
                document.getElementById(p+'-mentah-val').innerText = sM; 
                document.getElementById(p+'-ungkep-val').innerText = sU; 
                document.getElementById(p+'-ikan-val').innerText = sI; 
                document.getElementById(p+'-ikanlaut-val').innerText = sIL; 
            });
            
            let hH = ''; 
            hArr.sort((a,b)=> (b.time||0) - (a.time||0)).slice(0,20).forEach(h => {
                const isKeluar = h.status === 'Keluar' || h.note?.includes('KELUAR');
                const colorBorder = (h.type === 'IkanLaut') ? 'border-cyan-400' : (isKeluar ? 'border-red-500' : 'border-emerald-500');
                hH += `<div class="stat-card border-l-4 ${colorBorder} py-4 mb-2">
                    <div class="flex justify-between items-center">
                        <div><p class="text-white font-black text-sm uppercase">${h.type}</p><p class="text-[9px] text-zinc-500 font-bold uppercase">${h.note || h.status}</p></div>
                        <p class="text-xl font-black ${isKeluar?'text-red-500':'text-emerald-500'}">${isKeluar?'-':'+'}${h.qty}</p>
                    </div>
                </div>`;
            });
            document.getElementById('list-history-stok').innerHTML = hH;
        });

        // --- ADMIN FUNCTIONS ---
        window.openModalFAB = (type) => { 
            currentTypeFAB = type; 
            document.getElementById('modal-admin-action').value = "Masuk";
            document.getElementById('opt-proses').style.display = (type === 'Ungkep' || type === 'Mentah') ? 'block' : 'none';
            updateModalLabel();
            document.getElementById('modal-stok').classList.add('show'); 
        };

        window.updateModalLabel = () => {
            const mode = document.getElementById('modal-admin-action').value;
            if(mode === 'Proses') {
                document.getElementById('modal-title-main').innerText = "Proses Masak";
                document.getElementById('modal-title-type').innerText = "Kurangi Mentah -> Masuk Ungkep";
            } else {
                document.getElementById('modal-title-main').innerText = "Update Stok Baru";
                document.getElementById('modal-title-type').innerText = "TAMBAH " + currentTypeFAB.toUpperCase();
            }
        };

        window.prosesSimpanAdmin = () => {
            const q = parseInt(document.getElementById('modal-qty-input').value);
            const mode = document.getElementById('modal-admin-action').value;
            if(!q) return;
            const time = Date.now();
            const ref = dbStok.ref('stok_macca_v14_flow');
            if(mode === 'Proses') {
                ref.push({ type: 'Mentah', qty: q, status: "Keluar", note: "PROSES UNGKEP (ADMIN)", time: time, user: "SUPER ADMIN", price: 0 });
                ref.push({ type: 'Ungkep', qty: q, status: "Masuk", note: "HASIL UNGKEP (ADMIN)", time: time, user: "SUPER ADMIN", price: 0 }).then(onDone);
            } else {
                ref.push({ type: currentTypeFAB, qty: q, status: "Masuk", note: "STOK MASUK (ADMIN)", time: time, user: "SUPER ADMIN", price: 0 }).then(onDone);
            }
        };

        function onDone() {
            closeModal(); document.getElementById('modal-qty-input').value = '';
            document.getElementById('toast-notif').classList.add('show'); 
            setTimeout(()=>document.getElementById('toast-notif').classList.remove('show'), 2000);
        }

        window.closeModal = () => document.getElementById('modal-stok').classList.remove('show');

        // --- OTHER RENDERS ---
        dbLaundry.ref('Pesanan').on('value', snap => {
            rawLaundry = []; let wait = 0;
            snap.forEach(c => { const o = c.val(); rawLaundry.push(o); if(o.status === "MENUNGGU_DRIVER") wait++; });
            document.getElementById('dash-laundry-count').innerText = wait;
            renderLaundry(); renderDriverPerformance();
        });

        dbDelivery.ref('orders').on('value', snap => {
            rawDelivery = []; snap.forEach(c => { rawDelivery.push(c.val()); });
            renderDriverPerformance();
        });

        function renderDriverPerformance() {
            const list = document.getElementById('driver-performance-list');
            const selB = parseInt(document.getElementById('d-select-bulan').value);
            const selT = parseInt(document.getElementById('d-select-tahun').value);
            let stats = {};
            rawLaundry.forEach(o => {
                if(o.status === "SELESAI" && o.selesai) {
                    const dt = new Date(o.selesai);
                    if(dt.getMonth() === selB && dt.getFullYear() === selT) {
                        const name = o.driverName || "Unknown";
                        if(!stats[name]) stats[name] = { laundry: 0, delivery: 0 };
                        stats[name].laundry++;
                    }
                }
            });
            rawDelivery.forEach(o => {
                if(o.status === "delivered" && o.timestamp) {
                    const dt = new Date(o.timestamp);
                    if(dt.getMonth() === selB && dt.getFullYear() === selT) {
                        const name = o.driver || "Unknown";
                        if(!stats[name]) stats[name] = { laundry: 0, delivery: 0 };
                        stats[name].delivery++;
                    }
                }
            });
            let html = '';
            Object.keys(stats).forEach(name => {
                html += `<div class="stat-card border-l-4 border-gold mb-3">
                    <div class="flex justify-between items-center">
                        <div><h4 class="nama-pemesan text-white uppercase">${name}</h4><p class="text-[10px] text-zinc-500 font-bold uppercase">Total: ${stats[name].laundry + stats[name].delivery}</p></div>
                    </div>
                </div>`;
            });
            list.innerHTML = html || '<p class="text-center py-10 opacity-30 italic font-bold">TIDAK ADA DATA</p>';
        }

        function renderLaundry() {
            const list = document.getElementById('list-laundry');
            const filterDate = new Date(document.getElementById('l-input-date').value).toDateString();
            let html = '';
            rawLaundry.filter(o => new Date(o.mulai).toDateString() === filterDate).reverse().forEach(o => {
                html += `<div class="stat-card border-l-4 ${o.status==='SELESAI'?'border-emerald-500':'border-blue-500'} mb-3">
                    <div class="flex justify-between"><div><h4 class="nama-pemesan uppercase">${o.nama}</h4><p class="text-header-small">${o.layanan}</p></div><span class="text-[10px] font-bold text-zinc-500">${o.status}</span></div>
                </div>`;
            });
            list.innerHTML = html || '<p class="text-center py-10 opacity-30 italic font-bold">TIDAK ADA PESANAN</p>';
        }

        window.renderKopi = () => {
            const list = document.getElementById('list-kopi'); let total = 0, html = '';
            const h = document.getElementById('k-input-hari').value, m = parseInt(document.getElementById('k-input-bulan').value), y = parseInt(document.getElementById('k-input-bulan-thn').value);
            const filtered = (window.allKopi || []).filter(t => {
                const d = new Date(t.tgl);
                return modeKopi === 'hari' ? d.toDateString() === new Date(h).toDateString() : d.getMonth() === m && d.getFullYear() === y;
            });
            filtered.forEach(t => {
                total += (t.total || 0);
                html += `<div class="stat-card border-l-4 border-gold mb-3"><div class="flex justify-between"><div><p class="nama-pemesan">${t.nama || 'Customer'}</p><p class="text-[10px]">${t.lokasi || '-'}</p></div><p class="text-gold font-black">Rp ${t.total.toLocaleString()}</p></div></div>`;
            });
            list.innerHTML = html; document.getElementById('k-total-display').innerText = "Rp " + total.toLocaleString();
        };

        window.switchPage = (id, btn) => {
            document.querySelectorAll('.page-content').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('nav button').forEach(b => b.classList.remove('nav-active', 'text-zinc-500'));
            document.getElementById('page-'+id).classList.add('active');
            btn.classList.add('nav-active');
        };

        window.setModeKopi = (m) => { 
            modeKopi = m; 
            document.getElementById('k-tab-hari').classList.toggle('active', m==='hari'); 
            document.getElementById('k-tab-bulan').classList.toggle('active', m==='bulan');
            document.getElementById('k-wrap-hari').classList.toggle('hidden', m!=='hari'); 
            document.getElementById('k-wrap-bulan').classList.toggle('hidden', m!=='bulan'); 
            renderKopi(); 
        };

        window.onload = () => {
            const yr = new Date().getFullYear(), m = new Date().getMonth();
            const bln = ["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"];
            const sb = document.getElementById('k-input-bulan'), sb2 = document.getElementById('d-select-bulan');
            bln.forEach((b, i) => { const o = `<option value="${i}">${b}</option>`; sb.innerHTML += o; sb2.innerHTML += o; });
            const sy = document.getElementById('k-input-bulan-thn'), sy2 = document.getElementById('d-select-tahun');
            for(let i=yr; i>=2024; i--) { const o = `<option value="${i}">${i}</option>`; sy.innerHTML += o; sy2.innerHTML += o; }
            sb.value = m; sb2.value = m;
            document.getElementById('k-input-hari').valueAsDate = new Date();
            document.getElementById('l-input-date').valueAsDate = new Date();
        };
    </script>
</body>
</html>
